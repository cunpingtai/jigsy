import { FC, useState, useRef, useEffect, useCallback } from "react";
import { Label } from "@/components/ui/label";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import { Slider } from "@/components/ui/slider";
import { cn } from "@/lib/utils";
import { debounce } from "lodash";
import { useI18n } from "@/app/[locale]/providers";

type EmojiPuzzleCreatorMeta = {
  emoji?: string;
  backgroundColor?: string;
  emojiRotation?: number;
  selectedCategory?: string;
};

type EmojiPuzzleCreatorProps = {
  width?: number;
  height?: number;
  onGenerate?: (image: string, meta: EmojiPuzzleCreatorMeta) => void;
  meta?: EmojiPuzzleCreatorMeta;
};

export const EmojiPuzzleCreator: FC<EmojiPuzzleCreatorProps> = ({
  width,
  height,
  onGenerate,
  meta,
}) => {
  // 预设 Emoji 分类和表情
  const emojiCategories = {
    faces: {
      name: "表情与情感",
      emojis: [
        "😀",
        "😃",
        "😄",
        "😁",
        "😆",
        "😅",
        "🤣",
        "😂",
        "🙂",
        "🙃",
        "😉",
        "😊",
        "😇",
        "🥰",
        "😍",
        "🤩",
        "😘",
        "😗",
        "😚",
        "😙",
        "😋",
        "😛",
        "😜",
        "🤪",
        "😝",
        "🤑",
        "🤗",
        "🤭",
        "🤫",
        "🤔",
        "🤐",
        "🤨",
        "😐",
        "😑",
        "😶",
        "😏",
        "😒",
        "🙄",
        "😬",
        "🤥",
        "😌",
        "😔",
        "😪",
        "🤤",
        "😴",
      ],
    },
    emotions: {
      name: "情绪与手势",
      emojis: [
        "😷",
        "🤒",
        "🤕",
        "🤢",
        "🤮",
        "🤧",
        "🥵",
        "🥶",
        "🥴",
        "😵",
        "🤯",
        "🤠",
        "🥳",
        "😎",
        "🤓",
        "🧐",
        "😕",
        "😟",
        "🙁",
        "☹️",
        "😮",
        "😯",
        "😲",
        "😳",
        "🥺",
        "😦",
        "😧",
        "😨",
        "😰",
        "😥",
        "😢",
        "😭",
        "😱",
        "😖",
        "😣",
        "😞",
        "😓",
        "😩",
        "😫",
        "🥱",
        "😤",
        "😡",
        "😠",
        "🤬",
        "👍",
        "👎",
        "👌",
        "✌️",
        "🤞",
        "🤟",
        "🤘",
        "👋",
      ],
    },
    nature: {
      name: "自然与植物",
      emojis: [
        "🌱",
        "🌲",
        "🌳",
        "🌴",
        "🌵",
        "🌿",
        "☘️",
        "🍀",
        "🍁",
        "🍂",
        "🍃",
        "🌺",
        "🌸",
        "🌼",
        "🌻",
        "🌞",
        "🌝",
        "🌛",
        "🌜",
        "🌚",
        "🌕",
        "🌖",
        "🌗",
        "🌘",
        "🌑",
        "🌒",
        "🌓",
        "🌔",
        "🌙",
        "🌎",
        "🌍",
        "🌏",
        "💫",
        "⭐",
        "🌟",
        "✨",
        "⚡",
        "☄️",
        "💥",
        "🔥",
        "🌈",
        "☀️",
        "🌤️",
        "⛅",
        "🌥️",
        "☁️",
        "🌦️",
        "🌧️",
        "⛈️",
        "🌩️",
        "🌨️",
        "❄️",
        "☃️",
        "⛄",
        "🌬️",
        "💨",
      ],
    },
    food: {
      name: "食物与饮料",
      emojis: [
        "🍏",
        "🍎",
        "🍐",
        "🍊",
        "🍋",
        "🍌",
        "🍉",
        "🍇",
        "🍓",
        "🍈",
        "🍒",
        "🍑",
        "🥭",
        "🍍",
        "🥥",
        "🥝",
        "🍅",
        "🍆",
        "🥑",
        "🥦",
        "🥬",
        "🥒",
        "🌶️",
        "🌽",
        "🥕",
        "🧄",
        "🧅",
        "🥔",
        "🍠",
        "🥐",
        "🥯",
        "🍞",
        "🥖",
        "🥨",
        "🧀",
        "🥚",
        "🍳",
        "🧈",
        "🥞",
        "🧇",
        "🥓",
        "🥩",
        "🍗",
        "🍖",
        "🦴",
        "🌭",
        "🍔",
        "🍟",
        "🍕",
        "🥪",
        "🥙",
        "🧆",
        "🌮",
        "🌯",
        "🥗",
        "🥘",
        "🥫",
        "🍝",
        "🍜",
        "🍲",
        "🍛",
        "🍣",
        "🍱",
        "🥟",
        "🦪",
        "🍤",
        "🍙",
        "🍚",
        "🍘",
        "🍥",
        "🥠",
        "🥮",
        "🍢",
        "🍡",
        "🍧",
        "🍨",
        "🍦",
        "🥧",
        "🧁",
        "🍰",
        "🎂",
        "🍮",
        "🍭",
        "🍬",
        "🍫",
        "🍿",
        "🍩",
        "🍪",
        "🌰",
        "🥜",
        "☕",
        "🍵",
        "🧃",
        "🥤",
        "🍶",
        "🍺",
        "🍻",
        "🥂",
        "🍷",
        "🥃",
        "🍸",
        "🍹",
        "🧉",
        "🍾",
        "🧊",
      ],
    },
    animals: {
      name: "动物与自然",
      emojis: [
        "🐶",
        "🐱",
        "🐭",
        "🐹",
        "🐰",
        "🦊",
        "🐻",
        "🐼",
        "🐨",
        "🐯",
        "🦁",
        "🐮",
        "🐷",
        "🐽",
        "🐸",
        "🐵",
        "🙈",
        "🙉",
        "🙊",
        "🐒",
        "🐔",
        "🐧",
        "🐦",
        "🐤",
        "🐣",
        "🐥",
        "🦆",
        "🦅",
        "🦉",
        "🦇",
        "🐺",
        "🐗",
        "🐴",
        "🦄",
        "🐝",
        "🐛",
        "🦋",
        "🐌",
        "🐞",
        "🐜",
        "🦟",
        "🦗",
        "🕷️",
        "🕸️",
        "🦂",
        "🐢",
        "🐍",
        "🦎",
        "🦖",
        "🦕",
        "🐙",
        "🦑",
        "🦐",
        "🦞",
        "🦀",
        "🐡",
        "🐠",
        "🐟",
        "🐬",
        "🐳",
        "🐋",
        "🦈",
        "🐊",
        "🐅",
        "🐆",
        "🦓",
        "🦍",
        "🦧",
        "🐘",
        "🦛",
        "🦏",
        "🐪",
        "🐫",
        "🦒",
        "🦘",
        "🐃",
        "🐂",
        "🐄",
        "🐎",
        "🐖",
        "🐏",
        "🐑",
        "🦙",
        "🐐",
        "🦌",
        "🐕",
        "🐩",
        "🦮",
        "🐕‍🦺",
        "🐈",
        "🐓",
        "🦃",
        "🦚",
        "🦜",
        "🦢",
        "🦩",
        "🕊️",
        "🐇",
        "🦝",
        "🦨",
        "🦡",
        "🦦",
        "🦥",
        "🐁",
        "🐀",
        "🐿️",
        "🦔",
      ],
    },
    objects: {
      name: "物品与符号",
      emojis: [
        "❤️",
        "🧡",
        "💛",
        "💚",
        "💙",
        "💜",
        "🖤",
        "🤍",
        "🤎",
        "💔",
        "❣️",
        "💕",
        "💞",
        "💓",
        "💗",
        "💖",
        "💘",
        "💝",
        "💟",
        "☮️",
        "✝️",
        "☪️",
        "🕉️",
        "☸️",
        "✡️",
        "🔯",
        "🕎",
        "☯️",
        "☦️",
        "🛐",
        "⛎",
        "♈",
        "♉",
        "♊",
        "♋",
        "♌",
        "♍",
        "♎",
        "♏",
        "♐",
        "♑",
        "♒",
        "♓",
        "🆔",
        "⚛️",
        "🉑",
        "☢️",
        "☣️",
        "📴",
        "📳",
        "🈶",
        "🈚",
        "🈸",
        "🈺",
        "🈷️",
        "✴️",
        "🆚",
        "💮",
        "🉐",
        "㊙️",
        "㊗️",
        "🈴",
        "🈵",
        "🈹",
        "🈲",
        "🅰️",
        "🅱️",
        "🆎",
        "🆑",
        "🅾️",
        "🆘",
        "❌",
        "⭕",
        "🛑",
        "⛔",
        "📛",
        "🚫",
        "💯",
        "💢",
        "♨️",
        "🚷",
        "🚯",
        "🚳",
        "🚱",
        "🔞",
        "📵",
        "🚭",
        "❗",
        "❕",
        "❓",
        "❔",
        "‼️",
        "⁉️",
        "🔅",
        "🔆",
        "〽️",
        "⚠️",
        "🚸",
        "🔱",
        "⚜️",
        "🔰",
        "♻️",
        "✅",
        "🈯",
        "💹",
        "❇️",
        "✳️",
        "❎",
        "🌐",
        "💠",
        "Ⓜ️",
        "🌀",
        "💤",
        "🏧",
        "🚾",
        "♿",
        "🅿️",
        "🈳",
        "🈂️",
        "🛂",
        "🛃",
        "🛄",
        "🛅",
        "🚹",
        "🚺",
        "🚼",
        "⚧",
        "🚻",
        "🚮",
        "🎦",
        "📶",
        "🈁",
        "🔣",
        "ℹ️",
        "🔤",
        "🔡",
        "🔠",
        "🆖",
        "🆗",
        "🆙",
        "🆒",
        "🆕",
        "🆓",
        "0️⃣",
        "1️⃣",
        "2️⃣",
        "3️⃣",
        "4️⃣",
        "5️⃣",
        "6️⃣",
        "7️⃣",
        "8️⃣",
        "9️⃣",
        "🔟",
        "🔢",
        "#️⃣",
        "*️⃣",
        "⏏️",
        "▶️",
        "⏸️",
        "⏯️",
        "⏹️",
        "⏺️",
        "⏭️",
        "⏮️",
        "⏩",
        "⏪",
        "⏫",
        "⏬",
        "◀️",
        "🔼",
        "🔽",
        "➡️",
        "⬅️",
        "⬆️",
        "⬇️",
        "↗️",
        "↘️",
        "↙️",
        "↖️",
        "↕️",
        "↔️",
        "↪️",
        "↩️",
        "⤴️",
        "⤵️",
        "🔀",
        "🔁",
        "🔂",
        "🔄",
        "🔃",
        "🎵",
        "🎶",
        "➕",
        "➖",
        "➗",
        "✖️",
        "♾️",
        "💲",
        "💱",
        "™️",
        "©️",
        "®️",
        "〰️",
        "➰",
        "➿",
        "🔚",
        "🔙",
        "🔛",
        "🔝",
        "🔜",
        "✔️",
        "☑️",
        "🔘",
        "🔴",
        "🟠",
        "🟡",
        "🟢",
        "🔵",
        "🟣",
        "⚫",
        "⚪",
        "🟤",
        "🔺",
        "🔻",
        "🔸",
        "🔹",
        "🔶",
        "🔷",
        "🔳",
        "🔲",
        "▪️",
        "▫️",
        "◾",
        "◽",
        "◼️",
        "◻️",
        "🟥",
        "🟧",
        "🟨",
        "🟩",
        "🟦",
        "🟪",
        "⬛",
        "⬜",
        "🟫",
        "🔈",
        "🔇",
        "🔉",
        "🔊",
        "🔔",
        "🔕",
        "📣",
        "📢",
        "👁️‍🗨️",
        "💬",
        "💭",
        "🗯️",
        "♠️",
        "♣️",
        "♥️",
        "♦️",
        "🃏",
        "🎴",
        "🀄",
        "🕐",
        "🕑",
        "🕒",
        "🕓",
        "🕔",
        "🕕",
        "🕖",
        "🕗",
        "🕘",
        "🕙",
        "🕚",
        "🕛",
        "🕜",
        "🕝",
        "🕞",
        "🕟",
        "🕠",
        "🕡",
        "🕢",
        "🕣",
        "🕤",
        "🕥",
        "🕦",
        "🕧",
      ],
    },
    activities: {
      name: "活动与运动",
      emojis: [
        "🎪",
        "🤹",
        "🎭",
        "🎨",
        "🎬",
        "🎤",
        "🎧",
        "🎼",
        "🎹",
        "🥁",
        "🎷",
        "🎺",
        "🎸",
        "🎻",
        "🎲",
        "♟️",
        "🎯",
        "🎳",
        "🎮",
        "🎰",
        "🧩",
        "🚗",
        "🚕",
        "🚙",
        "🚌",
        "🚎",
        "🏎️",
        "🚓",
        "🚑",
        "🚒",
        "🚐",
        "🚚",
        "🚛",
        "🚜",
        "🦯",
        "🦽",
        "🦼",
        "🛴",
        "🚲",
        "🛵",
        "🏍️",
        "🛺",
        "🚨",
        "🚔",
        "🚍",
        "🚘",
        "🚖",
        "🚡",
        "🚠",
        "🚟",
        "🚃",
        "🚋",
        "🚞",
        "🚝",
        "🚄",
        "🚅",
        "🚈",
        "🚂",
        "🚆",
        "🚇",
        "🚊",
        "🚉",
        "✈️",
        "🛫",
        "🛬",
        "🛩️",
        "💺",
        "🛰️",
        "🚀",
        "🛸",
        "🚁",
        "🛶",
        "⛵",
        "🚤",
        "🛥️",
        "🛳️",
        "⛴️",
        "🚢",
        "⚓",
        "⛽",
        "🚧",
        "🚦",
        "🚥",
        "🚏",
        "🗺️",
        "🗿",
        "🗽",
        "🗼",
        "🏰",
        "🏯",
        "🏟️",
        "🎡",
        "🎢",
        "🎠",
        "⛲",
        "⛱️",
        "🏖️",
        "🏝️",
        "🏜️",
        "🌋",
        "⛰️",
        "🏔️",
        "🗻",
        "🏕️",
        "⛺",
        "🏠",
        "🏡",
        "🏘️",
        "🏚️",
        "🏗️",
        "🏢",
        "🏬",
        "🏣",
        "🏤",
        "🏥",
        "🏦",
        "🏨",
        "🏪",
        "🏫",
        "🏩",
        "💒",
        "🏛️",
        "⛪",
        "🕌",
        "🕍",
        "🛕",
        "🕋",
        "⛩️",
        "🛤️",
        "🛣️",
        "🗾",
        "🎑",
        "🏞️",
        "🌅",
        "🌄",
        "🌠",
        "🎇",
        "🎆",
        "🌇",
        "🌆",
        "🏙️",
        "🌃",
        "🌌",
        "🌉",
        "🌁",
        "⚽",
        "⚾",
        "🥎",
        "🏀",
        "🏐",
        "🏈",
        "🏉",
        "🎾",
        "🥏",
        "🏏",
        "🏑",
        "🏒",
        "🥍",
        "🏓",
        "🏸",
        "🥊",
        "🥋",
        "🥅",
        "⛳",
        "⛸️",
        "🎣",
        "🤿",
        "🎽",
        "🎿",
        "🛷",
        "🥌",
        "🎯",
        "🪀",
        "🪁",
        "🎱",
        "🔮",
        "🧿",
        "🎮",
        "🕹️",
        "🎰",
        "🎲",
        "🧩",
        "🧸",
        "♟️",
        "🎭",
        "🖼️",
        "🎨",
        "🧵",
        "🧶",
        "👓",
        "🕶️",
        "🥽",
        "🥼",
        "🦺",
        "👔",
        "👕",
        "👖",
        "🧣",
        "🧤",
        "🧥",
        "🧦",
        "👗",
        "👘",
        "🥻",
        "🩱",
        "🩲",
        "🩳",
        "👙",
        "👚",
        "👛",
        "👜",
        "👝",
        "🛍️",
        "🎒",
        "👞",
        "👟",
        "🥾",
        "🥿",
        "👠",
        "👡",
        "🩰",
        "👢",
        "👑",
        "👒",
        "🎩",
        "🎓",
        "🧢",
        "⛑️",
        "📿",
        "💄",
        "💍",
        "💎",
        "📱",
        "📲",
        "💻",
        "⌨️",
        "🖥️",
        "🖨️",
        "🖱️",
        "🖲️",
        "🕹️",
        "🗜️",
        "💽",
        "💾",
        "💿",
        "📀",
        "📼",
        "📷",
        "📸",
        "📹",
        "🎥",
        "📽️",
        "🎞️",
        "📞",
        "☎️",
        "📟",
        "📠",
        "📺",
        "📻",
        "🎙️",
        "🎚️",
        "🎛️",
        "🧭",
        "⏱️",
        "⏲️",
        "⏰",
        "🕰️",
        "⌛",
        "⏳",
        "📡",
        "🔋",
        "🔌",
        "💡",
        "🔦",
        "🕯️",
        "🪔",
        "🧯",
        "🛢️",
        "💸",
        "💵",
        "💴",
        "💶",
        "💷",
        "💰",
        "💳",
        "💎",
        "⚖️",
        "🧰",
        "🔧",
        "🔨",
        "⚒️",
        "🛠️",
        "🧲",
        "🔩",
        "⚙️",
        "🧱",
        "⛓️",
        "🧪",
        "🧫",
        "🧬",
        "🔬",
        "🔭",
        "📡",
        "💉",
        "🩸",
        "💊",
        "🩹",
        "🩺",
        "🚪",
        "🛏️",
        "🛋️",
        "🪑",
        "🚽",
        "🚿",
        "🛁",
        "🪒",
        "🧴",
        "🧷",
        "🧹",
        "🧺",
        "🧻",
        "🧼",
        "🧽",
        "🧯",
        "🛒",
        "🚬",
        "⚰️",
        "⚱️",
        "🗿",
        "🏧",
        "🚮",
        "🚰",
        "♿",
        "🚹",
        "🚺",
        "🚻",
        "🚼",
        "🚾",
        "🛂",
        "🛃",
        "🛄",
        "🛅",
        "⚠️",
        "🚸",
        "⛔",
        "🚫",
        "🚳",
        "🚭",
        "🚯",
        "🚱",
        "🚷",
        "📵",
        "🔞",
        "☢️",
        "☣️",
        "⬆️",
        "↗️",
        "➡️",
        "↘️",
        "⬇️",
        "↙️",
        "⬅️",
        "↖️",
        "↕️",
        "↔️",
        "↩️",
        "↪️",
        "⤴️",
        "⤵️",
        "🔃",
        "🔄",
        "🔙",
        "🔚",
        "🔛",
        "🔜",
        "🔝",
        "🛐",
        "⚛️",
        "🕉️",
        "✡️",
        "☸️",
        "☯️",
        "✝️",
        "☦️",
        "☪️",
        "☮️",
        "🕎",
        "🔯",
        "♈",
        "♉",
        "♊",
        "♋",
        "♌",
        "♍",
        "♎",
        "♏",
        "♐",
        "♑",
        "♒",
        "♓",
        "⛎",
        "🔀",
        "🔁",
        "🔂",
        "▶️",
        "⏩",
        "⏭️",
        "⏯️",
        "◀️",
        "⏪",
        "⏮️",
        "🔼",
        "⏫",
        "🔽",
        "⏬",
        "⏸️",
        "⏹️",
        "⏺️",
        "⏏️",
        "🎦",
        "🔅",
        "🔆",
        "📶",
        "📳",
        "📴",
        "♀️",
        "♂️",
        "⚧",
        "✖️",
        "➕",
        "➖",
        "➗",
        "♾️",
        "‼️",
        "⁉️",
        "❓",
        "❔",
        "❕",
        "❗",
        "〰️",
        "💱",
        "💲",
        "⚕️",
        "♻️",
        "⚜️",
        "🔱",
        "📛",
        "🔰",
        "⭕",
        "✅",
        "☑️",
        "✔️",
        "❌",
        "❎",
        "➰",
        "➿",
        "〽️",
        "✳️",
        "✴️",
        "❇️",
        "©️",
        "®️",
        "™️",
        "#️⃣",
        "*️⃣",
        "0️⃣",
        "1️⃣",
        "2️⃣",
        "3️⃣",
        "4️⃣",
        "5️⃣",
        "6️⃣",
        "7️⃣",
        "8️⃣",
        "9️⃣",
        "🔟",
        "🔠",
        "🔡",
        "🔢",
        "🔣",
        "🔤",
        "🅰️",
        "🆎",
        "🅱️",
        "🆑",
        "🆒",
        "🆓",
        "ℹ️",
        "🆔",
        "Ⓜ️",
        "🆕",
        "🆖",
        "🅾️",
        "🆗",
        "🅿️",
        "🆘",
        "🆙",
        "🆚",
        "🈁",
        "🈂️",
        "🈷️",
        "🈶",
        "🈯",
        "🉐",
        "🈹",
        "🈚",
        "🈲",
        "🉑",
        "🈸",
        "🈴",
        "🈳",
        "㊗️",
        "㊙️",
        "🈺",
        "🈵",
        "🔴",
        "🟠",
        "🟡",
        "🟢",
        "🔵",
        "🟣",
        "🟤",
        "⚫",
        "⚪",
        "🟥",
        "🟧",
        "🟨",
        "🟩",
        "🟦",
        "🟪",
        "🟫",
        "⬛",
        "⬜",
        "◼️",
        "◻️",
        "◾",
        "◽",
        "▪️",
        "▫️",
        "🔶",
        "🔷",
        "🔸",
        "🔹",
        "🔺",
        "🔻",
        "💠",
        "🔘",
        "🔳",
        "🔲",
        "🏁",
        "🚩",
        "🎌",
        "🏴",
        "🏳️",
        "🏳️‍🌈",
        "🏳️‍⚧️",
        "🏴‍☠️",
      ],
    },
  };
  const { data } = useI18n();

  const [selectedEmoji, setSelectedEmoji] = useState(meta?.emoji || "😊");
  const [backgroundColor, setBackgroundColor] = useState(
    meta?.backgroundColor || "#ffffff"
  );
  const [emojiRotation, setEmojiRotation] = useState(meta?.emojiRotation || 0);
  const [selectedCategory, setSelectedCategory] = useState(
    meta?.selectedCategory || "faces"
  );

  const canvasRef = useRef<HTMLCanvasElement>(null);
  const containerRef = useRef<HTMLDivElement>(null);

  const update = useCallback(
    debounce((canvas: HTMLCanvasElement, meta: EmojiPuzzleCreatorMeta) => {
      onGenerate?.(canvas.toDataURL("image/png"), meta);
    }, 300),
    []
  );
  // 使用Canvas渲染Emoji
  useEffect(() => {
    const canvas = canvasRef.current;
    if (!canvas) return;

    const ctx = canvas.getContext("2d");
    if (!ctx) return;

    // 设置canvas尺寸
    canvas.width = width || 1024;
    canvas.height = height || 1024;

    // 绘制背景
    ctx.fillStyle = backgroundColor;
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // 绘制Emoji
    ctx.save();

    // 移动到中心点
    ctx.translate(canvas.width / 2, canvas.height / 2);

    // 旋转
    ctx.rotate((emojiRotation * Math.PI) / 180);

    // 设置字体大小 - 使用画布宽度的70%作为字体大小，确保表情占满画布
    const fontSize = Math.floor(canvas.width * 0.7);
    ctx.font = `${fontSize}px Arial`;
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";

    // 绘制Emoji
    ctx.fillText(selectedEmoji, 0, 0);

    // 恢复画布状态
    ctx.restore();

    // 如果有onGenerate回调，传递图像数据
    if (onGenerate) {
      update(canvas, {
        emoji: selectedEmoji,
        backgroundColor,
        emojiRotation,
        selectedCategory,
      });
    }
  }, [
    selectedEmoji,
    backgroundColor,
    emojiRotation,
    onGenerate,
    update,
    width,
    height,
    selectedCategory,
  ]);

  return (
    <div className="space-y-6">
      {/* Emoji 预览 - 使用Canvas，确保水平居中 */}
      <div ref={containerRef} className="flex justify-center items-center">
        <canvas
          ref={canvasRef}
          className="rounded-lg shadow-inner"
          style={{
            width: "200px", // 增大预览尺寸
            height: "200px",
            display: "block",
          }}
        />
      </div>

      {/* Emoji 分类选择 */}
      <div className="space-y-2">
        <Label>{data.selectCategory}</Label>
        <Select value={selectedCategory} onValueChange={setSelectedCategory}>
          <SelectTrigger>
            <SelectValue />
          </SelectTrigger>
          <SelectContent>
            {Object.entries(emojiCategories).map(([key, category]) => (
              <SelectItem key={key} value={key}>
                {category.name}
              </SelectItem>
            ))}
          </SelectContent>
        </Select>
      </div>

      {/* Emoji 选择器 */}
      <div className="space-y-2">
        <Label>{data.selectEmoji}</Label>
        <div className="h-48 overflow-y-auto p-2 border rounded-md">
          <div className="grid grid-cols-12 gap-2">
            {emojiCategories[
              selectedCategory as keyof typeof emojiCategories
            ].emojis.map((emoji, index) => (
              <Button
                key={index}
                variant="outline"
                className={cn(
                  "aspect-square p-0",
                  selectedEmoji === emoji && "ring-2 ring-primary bg-primary/10"
                )}
                onClick={() => setSelectedEmoji(emoji)}
              >
                {emoji}
              </Button>
            ))}
          </div>
        </div>
      </div>

      {/* 背景颜色 */}
      <div className="space-y-2">
        <Label>{data.backgroundColor}</Label>
        <div className="flex gap-2">
          <Input
            type="color"
            value={backgroundColor}
            onChange={(e) => setBackgroundColor(e.target.value)}
            className="w-9 h-9 p-1 cursor-pointer"
          />
          <Input
            type="text"
            value={backgroundColor}
            onChange={(e) => setBackgroundColor(e.target.value)}
            className="flex-1"
          />
        </div>
      </div>

      {/* Emoji 旋转 */}
      <div className="space-y-2">
        <Label>{data.emojiRotation}</Label>
        <Slider
          value={[emojiRotation]}
          onValueChange={(value) => setEmojiRotation(value[0])}
          min={0}
          max={360}
          step={15}
        />
      </div>
    </div>
  );
};
